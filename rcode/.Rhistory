Death <- 110
P <- rep(1,Death)
delta <- 0.9
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t{
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( g^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(10,0.5)
Death <- 110
P <- rep(1,Death)
delta <- 0.9
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t{
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( g^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(10,0)
Death <- 110
P <- rep(1,Death)
delta <- 0.9
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t{
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( g^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
Death <- 110
P <- rep(1,Death)
delta <- 0.9
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t{
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
Death <- 110
P <- rep(1,Death)
delta <- 0.9
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
Death <- 110
P <- rep(1,Death)
delta <- 0.9
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
Death <- 110
P <- rep(1,Death)
delta <- 1
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
Death <- 110
P <- rep(1,Death)
delta <- 2
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
Death <- 110
P <- rep(1,Death)
delta <- 0.5
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
Death <- 110
P <- rep(1,Death)
delta <- 0.1
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
Death <- 110
P <- rep(1,Death)
delta <- 1
#utility function define:
crrautil <- function(C, g){
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
#utility function define:
crrautil <- function(C, g){
Death <- 110
P <- rep(1,Death)
delta <- 1
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
#utility function define:
crrautil <- function(C, g){
Death <- 110
P <- rep(1,Death)
delta <- 1
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
crrautil(1,0)
rm(list=ls())
crrautil(1,0)
#utility function define:
crrautil <- function(C, g){
Death <- 110
P <- rep(1,Death)
delta <- 1
crra <- 0
for(t in 1:Death){
surv_prob <- 1
for(j in 1:t){
surv_prob <- surv_prob * P[j]
}
sum_comp <- ( delta^(t-1) ) * surv_prob * (C^(1-g)) / (1-g)
crra <- crra + sum_comp
}
return(crra)
}
rm(list=ls())
library("zoo")
source("/home/ravshan/Dropbox/research/rcode/dfim.R")
rm(list=ls())
library("zoo")
source("/home/ravshan/Dropbox/research/mathesis/rcode/dfim.R")
#import raw income data from aktug and yigit
aktug <- read.csv(file="/home/ravshan/Dropbox/research/mathesis/data/aktug/aktug.csv", header = TRUE)
yigit <- read.csv(file="/home/ravshan/Dropbox/research/mathesis/data/yigit.csv", header=TRUE)
cpi   <- read.csv(file="/home/ravshan/Dropbox/research/mathesis/data/cpi.csv", header=FALSE)
surv  <- read.csv(file="/home/ravshan/Dropbox/research/mathesis/data/survival.csv", header=TRUE)[,2]
surv  <- cumprod(surv)
yigit$date <- as.yearmon(yigit$date)
wage <- aggregate(x = aktug, FUN = mean, by = list(aktug$year))[c("year", "income")]
w2 <- aggregate(x = aktug, FUN = median, by = list(aktug$age))[c("age", "income")]
wage <-na.spline(object = wage$income, x=wage$year, xout = yigit$date)
#wage <- na.locf(object = wage$income, x=wage$year, xout = yigit$date)
df <- yigit
df$wage <- wage
df$cpi <- cpi$V3
df$dhouse <- append(diff(df$house,12)/df$house[1:132],rep(NA,12),0)
df$dstock <- append(diff(df$stock,12)/df$stock[1:132],rep(NA,12),0)
df$dwage <- append(diff(df$wage,12)/df$wage[1:132],rep(NA,12),0)
df$inf <- append(diff(df$cpi, 12)/df$cpi[1:132],rep(NA,12),0)
df <- df[-c(1:12),]
LL <- rep(0,param_T); LL[1] <- w2[12,]$income*1.3
pdf(file = "Dropbox/research/tex/figs/heterwageless.pdf")
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,31000))
x <- c(rep(1.035,35), rep(1.03,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_moderate <- x
lines(x, type="l", col="orange")
x <- c(rep(1,35), rep(1,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_flat <- x
lines(x, type="l", col="green")
legend(x="topleft", y=0,legend = c("steep", "moderate", "flat"), fill = c("red", "orange", "green"), lty = c(1,1), cex = 1.5)
dev.off()
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,31000))
x <- c(rep(1.035,35), rep(1.03,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_moderate <- x
lines(x, type="l", col="orange")
x <- c(rep(1,35), rep(1,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_flat <- x
lines(x, type="l", col="green")
legend(x="topleft", y=0,legend = c("steep", "moderate", "flat"), fill = c("red", "orange", "green"), lty = c(1,1), cex = 1.5)
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,31000))
source("/home/ravshan/Dropbox/research/mathesis/rcode/param.R")
#common params
param_mu_s <- 0.232 #0.1058 #mean(df$dstock)
param_mu_h <- 0.113 #mean(subset(df$dhouse, df$dhouse>0))
param_sig_s <- 0.36 #0.017 #0.13 #sd(df$dstock)
param_sig_h <- 0.052 #0.01 #sd(subset(df$dhouse]))
param_sig_w <- 0.056 #sd(df$dwage)
param_rho_hs <- 0.24 #cor(df$dhouse, df$dstock)
param_rho_hw <- 0.37 #cor(df$dhouse, df$dwage)
param_beta  <- 0.89
param_r_f <- 0.108
param_inf <- 0.084
param_gamma <- 1.5
param_R <- 57 #retirement age
param_Y <- 28 #life cycle period
param_T <- param_R-param_Y+1
param_kappa <- 1
#heter params
param_mu_w_flat
param_mu_w_moderate
param_mu_w_steep
param_sig_eps_low <- 0.03
param_sig_eps_medium <- 0.05
param_sig_eps_high <- 0.07
param_rho_ws_low <- 0
param_rho_ws_medium <- 0.2
param_rho_ws_high <- 0.4
#individualized portfolios
LL <- rep(0,param_T); LL[1] <- w2[12,]$income*1.3
pdf(file = "Dropbox/research/mathesis/tex/figs/heterwageless.pdf")
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,31000))
x <- c(rep(1.035,35), rep(1.03,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_moderate <- x
lines(x, type="l", col="orange")
x <- c(rep(1,35), rep(1,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_flat <- x
lines(x, type="l", col="green")
legend(x="topleft", y=0,legend = c("steep", "moderate", "flat"), fill = c("red", "orange", "green"), lty = c(1,1), cex = 1.5)
dev.off()
#individualized portfolios
LL <- rep(0,param_T); LL[1] <- w2[12,]$income*1.3
pdf(file = "Dropbox/research/mathesis/tex/figs/heterwageless.pdf")
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,31000))
x <- c(rep(1.035,35), rep(1.03,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_moderate <- x
lines(x, type="l", col="orange")
x <- c(rep(1,35), rep(1,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_flat <- x
lines(x, type="l", col="green")
legend(x="topleft", y=0,legend = c("steep", "moderate", "flat"), fill = c("red", "orange", "green"), lty = c(1,1), cex = 1.5)
dev.off()
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
plot(x)
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
plot(x)
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,31000))
x <- c(rep(1.035,35), rep(1.03,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_moderate <- x
lines(x, type="l", col="orange")
x <- c(rep(1,35), rep(1,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_flat <- x
lines(x, type="l", col="green")
legend(x="topleft", y=0,legend = c("steep", "moderate", "flat"), fill = c("red", "orange", "green"), lty = c(1,1), cex = 1.5)
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,31000))
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,31000))
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x)
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,31000))
plot(x)
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(50000,310000))
x <- c(rep(1.035,35), rep(1.03,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_moderate <- x
lines(x, type="l", col="orange")
x <- c(rep(1,35), rep(1,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_flat <- x
lines(x, type="l", col="green")
legend(x="topleft", y=0,legend = c("steep", "moderate", "flat"), fill = c("red", "orange", "green"), lty = c(1,1), cex = 1.5)
x <- c(rep(1.065,35), rep(1.02,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_steep <- x
plot(x, type="l", col="red", xlab = "age", ylab = "wage", ylim = c(5000,150000))
x <- c(rep(1.035,35), rep(1.03,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_moderate <- x
lines(x, type="l", col="orange")
x <- c(rep(1,35), rep(1,10), rep(1,15))
x[1] <- LL[1]
x[1:35] <- cumprod(x[1:35])
x[35:45] <- cumprod(x[35:45])
x[45:60] <- cumprod(x[45:60])
x <- x[28:57]
LL_flat <- x
lines(x, type="l", col="green")
legend(x="topleft", y=0,legend = c("steep", "moderate", "flat"), fill = c("red", "orange", "green"), lty = c(1,1), cex = 1.5)
